# SportEase ユーザー権限別機能ガイド

## 目次
1. [権限レベルの概要](#1-権限レベルの概要)
2. [Root専用機能](#2-root専用機能)
3. [Admin機能（Admin/Root共通）](#3-admin機能adminroot共通)
4. [Student機能（全ユーザー共通）](#4-student機能全ユーザー共通)
5. [共通機能](#5-共通機能)
6. [権限別アクセス一覧表](#6-権限別アクセス一覧表)

---

## 1. 権限レベルの概要

SportEaseには以下の権限レベルがあります：

| 権限レベル | 説明 | 対象ユーザー |
|-----------|------|-------------|
| **Root** | システム管理者。全ての機能にアクセス可能 | システム運営者 |
| **Admin** | イベント管理者。管理機能と学生機能にアクセス可能 | 教員・スタッフ |
| **Student** | 一般ユーザー。学生向け機能にアクセス可能 | 生徒 |
| **クラス代表** | 動的に割り当てられる特別権限。自クラスのチーム管理が可能 | 各クラスの代表者 |

### 権限の取得方法
- **Root/Admin/Student**: ホワイトリストにメールアドレスを登録する際に設定
- **クラス代表**: 学生がマイページで初めてプロフィールを完成させた際に自動付与

---

## 2. Root専用機能

Root権限を持つユーザーのみがアクセスできる機能です。

### 2.1 大会情報登録・管理
**パス**: `/dashboard/root/event-management`

**機能概要**: スポーツ大会（イベント）の作成・編集・削除を行います。

**使用方法**:
1. サイドバーの「Root」セクションから「大会情報登録・管理」をクリック
2. 「新規大会作成」ボタンから新しい大会を登録
3. 既存の大会をクリックして編集・削除

**設定項目**:
- 大会名
- 開催日時
- 開催場所
- 大会のステータス（準備中/開催中/終了）

---

### 2.2 雨天時モード管理
**パス**: `/dashboard/root/rainy-mode`

**機能概要**: 雨天時の代替競技スケジュールへの切り替えを管理します。

**使用方法**:
1. サイドバーから「雨天時モード管理」をクリック
2. 雨天モードのON/OFFを切り替え
3. 雨天時の競技スケジュールを確認・調整

---

### 2.3 競技情報登録・管理
**パス**: `/dashboard/root/sport-management`

**機能概要**: 大会で実施する競技の登録・編集・削除を行います。

**使用方法**:
1. サイドバーから「競技情報登録・管理」をクリック
2. 「新規競技追加」から競技を登録
3. 競技名、ルール、開催日時、場所などを設定

**設定項目**:
- 競技名
- 競技種別（個人/団体）
- 参加対象学年
- 開催日時・場所
- ポイント配分

---

### 2.4 通知管理
**パス**: `/dashboard/root/notification`

**機能概要**: 全ユーザーへのプッシュ通知を管理・送信します。

**使用方法**:
1. サイドバーから「通知管理」をクリック
2. 「新規通知作成」でタイトルと本文を入力
3. 送信対象（全体/特定の学年/特定のクラス）を選択
4. 「送信」ボタンで即時送信、または予約送信を設定

---

### 2.5 通知申請管理
**パス**: `/dashboard/root/notification-requests`

**機能概要**: 学生からの通知申請を承認・却下します。

**使用方法**:
1. サイドバーから「通知申請管理」をクリック
2. 申請一覧から内容を確認
3. 「承認」または「却下」を選択
4. 承認された通知は自動的に全体へ送信

---

### 2.6 トーナメント生成・管理
**パス**: `/dashboard/root/tournament-management`

**機能概要**: 各競技のトーナメント表を自動生成・管理します。

**使用方法**:
1. サイドバーから「トーナメント生成・管理」をクリック
2. 対象競技を選択
3. 「トーナメント生成」でランダムにチームを配置
4. 必要に応じて手動で配置を調整
5. 「確定」で公開

---

### 2.7 昼競技管理
**パス**: `/dashboard/root/noon-game`

**機能概要**: 昼休みに行われる特別競技の設定・管理を行います。

**使用方法**:
1. サイドバーから「昼競技管理」をクリック
2. 昼競技の種目、参加者、ルールを設定
3. 実施日時を登録

---

### 2.8 ホワイトリスト
**パス**: `/dashboard/root/whitelist-management`

**機能概要**: ログイン可能なユーザーのメールアドレスと権限を管理します。

**使用方法**:
1. サイドバーから「ホワイトリスト」をクリック
2. 「ユーザー追加」で新規ユーザーを登録
   - メールアドレス
   - 権限レベル（root/admin/student）
3. 既存ユーザーの権限変更・削除も可能

**注意**: ホワイトリストに登録されていないメールアドレスはログインできません。

---

### 2.9 各クラス人数設定
**パス**: `/dashboard/root/class-student-count`

**機能概要**: 各クラスの生徒数を設定します。チーム編成の基準になります。

**使用方法**:
1. サイドバーから「各クラス人数設定」をクリック
2. 学年・クラスごとに人数を入力
3. 「保存」で設定を反映

---

### 2.10 ユーザー名変更
**パス**: `/dashboard/root/change-username`

**機能概要**: ユーザーの表示名を管理者権限で変更します。

**使用方法**:
1. サイドバーから「ユーザー名変更」をクリック
2. 対象ユーザーを検索
3. 新しい名前を入力して「変更」

---

### 2.11 MVP確認
**パス**: `/dashboard/root/identify-mvp`

**機能概要**: MVP投票の結果を確認・集計します。

**使用方法**:
1. サイドバーから「MVP確認」をクリック
2. 競技別・全体のMVP投票結果を確認
3. 最終結果を確定

---

### 2.12 競技要項アップロード
**パス**: `/dashboard/root/competition-guidelines-upload`

**機能概要**: 各競技のルールや要項のPDFファイルをアップロードします。

**使用方法**:
1. サイドバーから「競技要項アップロード」をクリック
2. 対象競技を選択
3. PDFファイルをドラッグ＆ドロップまたは選択してアップロード
4. アップロードされた要項は学生が「競技一覧・詳細閲覧」から確認可能

---

## 3. Admin機能（Admin/Root共通）

Admin権限以上のユーザーがアクセスできる機能です。

### 3.1 クラス・チーム割り当て
**パス**: `/dashboard/admin/class-management`

**機能概要**: 生徒を各競技のチームに割り当てます。

**使用方法**:
1. サイドバーの「Admin」セクションから「クラス・チーム割り当て」をクリック
2. 競技を選択
3. クラスと参加者を選択してチームに割り当て
4. 「保存」で確定

**備考**: クラス代表権限を持つユーザーは、自分のクラスのみ割り当て可能です。

---

### 3.2 ロール割り当て・管理
**パス**: `/dashboard/admin/role-management`

**機能概要**: ユーザーへのクラス代表権限の付与・削除を行います。

**使用方法**:
1. サイドバーから「ロール割り当て・管理」をクリック
2. ユーザーを検索
3. 「クラス代表」権限を付与または削除

**注意**: Root/Admin/Student の基本権限はホワイトリストで管理され、この画面では変更できません。

---

### 3.3 QRコード読み取り
**パス**: `/dashboard/admin/qr-code-reader`

**機能概要**: 生徒のQRコードをスキャンして参加確認を行います。

**使用方法**:
1. サイドバーから「QRコード読み取り」をクリック
2. カメラを起動してQRコードをスキャン
3. 読み取り成功で参加者として登録

---

### 3.4 QRコード参加本登録確認
**パス**: `/dashboard/admin/confirmed-participants`

**機能概要**: QRコードで登録済みの参加者一覧を確認します。

**使用方法**:
1. サイドバーから「QRコード参加本登録確認」をクリック
2. 競技・日時で絞り込み
3. 登録済み参加者の一覧を確認

---

### 3.5 試合結果入力
**パス**: `/dashboard/admin/insert-matche-result`

**機能概要**: 各試合の結果（スコア・勝敗）を入力します。

**使用方法**:
1. サイドバーから「試合結果入力」をクリック
2. 競技とマッチを選択
3. 各チームのスコアを入力
4. 「結果確定」で保存

---

### 3.6 出席登録
**パス**: `/dashboard/admin/attendance-management`

**機能概要**: 競技への出席状況を管理します。

**使用方法**:
1. サイドバーから「出席登録」をクリック
2. 競技・クラスを選択
3. 出席/欠席をチェック
4. 「保存」で確定

---

### 3.7 MVP投票
**パス**: `/dashboard/admin/vorting-mvp`

**機能概要**: 各競技のMVP（最優秀選手）に投票します。

**使用方法**:
1. サイドバーから「MVP投票」をクリック
2. 競技を選択
3. 1〜2年生の中からMVP候補を選択
4. 「投票」で確定

**注意**: MVP投票はAdmin/Rootのみが行えます。投票対象は1〜2年生のみです。

---

### 3.8 競技詳細情報登録
**パス**: `/dashboard/admin/sport-details-registration`

**機能概要**: 競技の詳細情報（会場、持ち物、注意事項など）を登録します。

**使用方法**:
1. サイドバーから「競技詳細情報登録」をクリック
2. 対象競技を選択
3. 詳細情報を入力
4. 「保存」で公開

---

### 3.9 昼競技結果入力
**パス**: `/dashboard/admin/noon-game-results`

**機能概要**: 昼競技の結果を入力します。

**使用方法**:
1. サイドバーから「昼競技結果入力」をクリック
2. 昼競技を選択
3. 結果・順位を入力
4. 「保存」で確定

---

## 4. Student機能（全ユーザー共通）

Student権限以上の全ユーザーがアクセスできる機能です。

### 4.1 マイページ
**パス**: `/dashboard/student/my-page`

**機能概要**: 自分のプロフィール情報を確認・編集します。

**使用方法**:
1. サイドバーの「Student」セクションから「マイページ」をクリック
2. 所属クラス、名前などを確認・編集
3. 「保存」で更新

**備考**: 初回プロフィール完成時に自動的にクラス代表権限が付与されます。

---

### 4.2 クラス情報
**パス**: `/dashboard/student/class-info`

**機能概要**: 自分のクラスのメンバーやチーム編成を確認します。

**使用方法**:
1. サイドバーから「クラス情報」をクリック
2. クラスメンバー一覧を確認
3. 各競技のチーム編成を確認

---

### 4.3 競技一覧・詳細閲覧
**パス**: `/dashboard/student/sport-info`

**機能概要**: 全競技の一覧と詳細情報を閲覧します。

**使用方法**:
1. サイドバーから「競技一覧・詳細閲覧」をクリック
2. 競技一覧から詳細を見たい競技をクリック
3. ルール、日時、場所、競技要項PDFなどを確認

---

### 4.4 トーナメント
**パス**: `/dashboard/student/tournament`

**機能概要**: 各競技のトーナメント表を閲覧します。

**使用方法**:
1. サイドバーから「トーナメント」をクリック
2. 競技を選択
3. トーナメント表と試合結果を確認

---

### 4.5 QRコード発行
**パス**: `/dashboard/student/issueqr-code`

**機能概要**: 参加確認用の個人QRコードを発行します。

**使用方法**:
1. サイドバーから「QRコード発行」をクリック
2. QRコードが画面に表示される
3. 競技会場でスタッフにスキャンしてもらう

---

### 4.6 点数一覧
**パス**: `/dashboard/student/score-list`

**機能概要**: クラス別・全体の得点ランキングを確認します。

**使用方法**:
1. サイドバーから「点数一覧」をクリック
2. 全クラスの総合得点を確認
3. 競技別の得点詳細も閲覧可能

---

### 4.7 昼競技結果
**パス**: `/dashboard/student/noon-game`

**機能概要**: 昼競技の結果を閲覧します。

**使用方法**:
1. サイドバーから「昼競技結果」をクリック
2. 各昼競技の結果・順位を確認

---

### 4.8 通知
**パス**: `/dashboard/student/notification`

**機能概要**: 受信した通知を確認します。

**使用方法**:
1. サイドバーから「通知」をクリック
2. 通知一覧から内容を確認
3. 新着通知はバッジで表示

---

### 4.9 通知申請
**パス**: `/dashboard/student/notification-request`

**機能概要**: 全体への通知送信を申請します。

**使用方法**:
1. サイドバーから「通知申請」をクリック
2. 通知タイトルと本文を入力
3. 「申請」で送信
4. Root管理者の承認後、全体に配信

---

## 5. 共通機能

### 5.1 資料
**パス**: `/dashboard/guide`

**機能概要**: アプリケーションの使い方ガイドや各種資料を閲覧します。

**使用方法**:
1. サイドバー下部の「資料」をクリック
2. 目的のガイドを選択して閲覧

---

## 6. 権限別アクセス一覧表

| 機能 | Root | Admin | Student | クラス代表 |
|------|:----:|:-----:|:-------:|:----------:|
| **Root専用** |
| 大会情報登録・管理 | ○ | - | - | - |
| 雨天時モード管理 | ○ | - | - | - |
| 競技情報登録・管理 | ○ | - | - | - |
| 通知管理 | ○ | - | - | - |
| 通知申請管理 | ○ | - | - | - |
| トーナメント生成・管理 | ○ | - | - | - |
| 昼競技管理 | ○ | - | - | - |
| ホワイトリスト | ○ | - | - | - |
| 各クラス人数設定 | ○ | - | - | - |
| ユーザー名変更 | ○ | - | - | - |
| MVP確認 | ○ | - | - | - |
| 競技要項アップロード | ○ | - | - | - |
| **Admin機能** |
| クラス・チーム割り当て | ○ | ○ | - | ○* |
| ロール割り当て・管理 | ○ | ○ | - | - |
| QRコード読み取り | ○ | ○ | - | - |
| QRコード参加本登録確認 | ○ | ○ | - | - |
| 試合結果入力 | ○ | ○ | - | - |
| 出席登録 | ○ | ○ | - | - |
| MVP投票 | ○ | ○ | - | - |
| 競技詳細情報登録 | ○ | ○ | - | - |
| 昼競技結果入力 | ○ | ○ | - | - |
| **Student機能** |
| マイページ | ○ | ○ | ○ | ○ |
| クラス情報 | ○ | ○ | ○ | ○ |
| 競技一覧・詳細閲覧 | ○ | ○ | ○ | ○ |
| トーナメント | ○ | ○ | ○ | ○ |
| QRコード発行 | ○ | ○ | ○ | ○ |
| 点数一覧 | ○ | ○ | ○ | ○ |
| 昼競技結果 | ○ | ○ | ○ | ○ |
| 通知 | ○ | ○ | ○ | ○ |
| 通知申請 | ○ | ○ | ○ | ○ |
| **共通** |
| 資料 | ○ | ○ | ○ | ○ |

*クラス代表は自分のクラスのみ編集可能

---

## 補足情報

### プッシュ通知について
- Student、Admin、Root権限を持つユーザーがプッシュ通知を受信できます
- ブラウザの通知許可が必要です

### セキュリティについて
- 各機能は権限に応じてフロントエンド（画面表示）とバックエンド（API）の両方で保護されています
- 権限のない機能にアクセスしようとすると、ダッシュボードにリダイレクトされます

### 権限の階層
```
Root > Admin > Student
```
上位の権限は下位の権限の機能全てにアクセスできます。
